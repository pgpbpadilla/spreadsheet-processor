package org.pgpb.spreadsheet;

import java.util.Comparator;
import java.util.List;

import static java.util.stream.Collectors.toList;

/*
 * This Java source file was generated by the Gradle 'init' task.
 */
public class Spreadsheet {
    private List<CellRow> rows;

    public Spreadsheet(List<CellRow> rows) {
        this.rows = rows;
    }

    public List<CellRow> getRows() {
        return rows;
    }

    public static Spreadsheet fromTsvLines(List<String> lines) {
        List<CellRow> rows = lines.stream()
            .map(CellRow::fromTsvLine)
            .collect(toList());
        return new Spreadsheet(rows);
    }

    public int getRowCount() {
        return rows.size();
    }

    public int columnCount() {
        return rows.stream()
            .map(r -> r.getCells().size())
            .max(Comparator.naturalOrder())
            .get();
    }
}
